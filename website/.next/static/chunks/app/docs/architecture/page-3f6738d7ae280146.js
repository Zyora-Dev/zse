(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2555],{3726:function(e,t,s){Promise.resolve().then(s.bind(s,4122))},4122:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var i=s(3827),r=s(9676),l=s(5558),n=s(4657),a=s(4987);let c=[{id:"overview",title:"Overview",level:2},{id:"components",title:"Core Components",level:2},{id:"inference-flow",title:"Inference Flow",level:2},{id:"memory-architecture",title:"Memory Architecture",level:2}];function d(){return(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsxs)("article",{className:"flex-1 min-w-0 py-8 px-6 lg:px-10",children:[(0,i.jsx)(r.lv,{title:"Architecture",description:"Deep dive into ZSE's internal architecture, component design, and how the pieces fit together.",badge:"Core Concepts"}),(0,i.jsxs)(r.Je,{id:"overview",title:"Overview",children:[(0,i.jsx)("p",{className:"mb-4",children:"ZSE is designed with one goal: minimize time-to-first-token while maintaining high throughput. The architecture consists of five core components that work together to achieve this."}),(0,i.jsx)("div",{className:"my-6 p-6 rounded-lg border border-white/[0.06] bg-white/[0.02]",children:(0,i.jsxs)("div",{className:"text-center text-sm font-mono",children:[(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[(0,i.jsx)("div",{className:"px-3 py-2 rounded bg-lime/20 text-lime border border-lime/30",children:"zQuantize"}),(0,i.jsx)("span",{className:"text-white/30",children:"→"}),(0,i.jsx)("div",{className:"px-3 py-2 rounded bg-white/10 text-white/70 border border-white/10",children:".zse File"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[(0,i.jsx)("div",{className:"px-3 py-2 rounded bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"zServe"}),(0,i.jsx)("span",{className:"text-white/30",children:"↔"}),(0,i.jsx)("div",{className:"px-3 py-2 rounded bg-purple-500/20 text-purple-400 border border-purple-500/30",children:"zInfer"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)("div",{className:"px-3 py-2 rounded bg-orange-500/20 text-orange-400 border border-orange-500/30",children:"zStream"}),(0,i.jsx)("span",{className:"text-white/30",children:"+"}),(0,i.jsx)("div",{className:"px-3 py-2 rounded bg-pink-500/20 text-pink-400 border border-pink-500/30",children:"zKV"})]})]})})]}),(0,i.jsxs)(r.Je,{id:"components",title:"Core Components",children:[(0,i.jsxs)(r.KU,{id:"zquantize-component",title:"zQuantize",children:[(0,i.jsxs)("p",{className:"mb-4",children:["The quantization engine that converts models to the optimized ",(0,i.jsx)(l.Z,{children:".zse"})," format."]}),(0,i.jsx)(a.VS,{features:["INT4, INT8, NF4 quantization schemes","Per-tensor scaling for minimal quality loss","Optimized memory layout for sequential loading","Preserves tokenizer and model config"]})]}),(0,i.jsxs)(r.KU,{id:"zserve-component",title:"zServe",children:[(0,i.jsx)("p",{className:"mb-4",children:"OpenAI-compatible HTTP server for production deployments."}),(0,i.jsx)(a.VS,{features:["Full OpenAI API compatibility","Server-Sent Events streaming","Batch processing support","API key authentication"]})]}),(0,i.jsxs)(r.KU,{id:"zinfer-component",title:"zInfer",children:[(0,i.jsx)("p",{className:"mb-4",children:"Low-level inference engine powering both CLI and API."}),(0,i.jsx)(a.VS,{features:["Direct tensor operations","Async token generation","Multi-GPU support","Dynamic batching"]})]}),(0,i.jsxs)(r.KU,{id:"zstream-component",title:"zStream",children:[(0,i.jsx)("p",{className:"mb-4",children:"Layer streaming for running models larger than available VRAM."}),(0,i.jsx)(a.VS,{features:["GPU ↔ CPU layer offloading","Automatic memory management","Run 70B models on 24GB GPUs","Minimal latency overhead"]})]}),(0,i.jsxs)(r.KU,{id:"zkv-component",title:"zKV",children:[(0,i.jsx)("p",{className:"mb-4",children:"Quantized KV cache for 4\xd7 memory savings during generation."}),(0,i.jsx)(a.VS,{features:["8-bit KV cache quantization","Paged attention support","Longer context windows","Sub-1% quality impact"]})]})]}),(0,i.jsxs)(r.Je,{id:"inference-flow",title:"Inference Flow",children:[(0,i.jsx)("p",{className:"mb-4",children:"When a request comes in, here's what happens:"}),(0,i.jsxs)("div",{className:"space-y-4 my-6",children:[(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)("div",{className:"w-8 h-8 rounded-full bg-lime/20 border border-lime/40 flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("span",{className:"text-xs font-bold text-lime",children:"1"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-white font-medium",children:"Request Received"}),(0,i.jsx)("p",{className:"text-sm text-white/50",children:"zServe validates the request and adds it to the batch queue"})]})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)("div",{className:"w-8 h-8 rounded-full bg-lime/20 border border-lime/40 flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("span",{className:"text-xs font-bold text-lime",children:"2"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-white font-medium",children:"Tokenization"}),(0,i.jsx)("p",{className:"text-sm text-white/50",children:"Input text is converted to token IDs using the model's tokenizer"})]})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)("div",{className:"w-8 h-8 rounded-full bg-lime/20 border border-lime/40 flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("span",{className:"text-xs font-bold text-lime",children:"3"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-white font-medium",children:"Forward Pass"}),(0,i.jsx)("p",{className:"text-sm text-white/50",children:"zInfer runs the model layers, storing KV cache with zKV"})]})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)("div",{className:"w-8 h-8 rounded-full bg-lime/20 border border-lime/40 flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("span",{className:"text-xs font-bold text-lime",children:"4"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-white font-medium",children:"Token Sampling"}),(0,i.jsx)("p",{className:"text-sm text-white/50",children:"Apply temperature, top-p, and sample next token"})]})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)("div",{className:"w-8 h-8 rounded-full bg-lime/20 border border-lime/40 flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("span",{className:"text-xs font-bold text-lime",children:"5"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-white font-medium",children:"Streaming Response"}),(0,i.jsx)("p",{className:"text-sm text-white/50",children:"Tokens are decoded and streamed back via SSE"})]})]})]})]}),(0,i.jsxs)(r.Je,{id:"memory-architecture",title:"Memory Architecture",children:[(0,i.jsx)("p",{className:"mb-4",children:"ZSE uses a three-tier memory hierarchy:"}),(0,i.jsx)("div",{className:"overflow-x-auto my-4",children:(0,i.jsxs)("table",{className:"w-full text-sm",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b border-white/10",children:[(0,i.jsx)("th",{className:"text-left py-2 pr-4 text-white/50 font-medium",children:"Tier"}),(0,i.jsx)("th",{className:"text-left py-2 px-4 text-white/50 font-medium",children:"Storage"}),(0,i.jsx)("th",{className:"text-left py-2 px-4 text-white/50 font-medium",children:"Content"}),(0,i.jsx)("th",{className:"text-left py-2 pl-4 text-white/50 font-medium",children:"Access Speed"})]})}),(0,i.jsxs)("tbody",{className:"text-white/70",children:[(0,i.jsxs)("tr",{className:"border-b border-white/[0.05]",children:[(0,i.jsx)("td",{className:"py-2 pr-4 text-lime",children:"Hot"}),(0,i.jsx)("td",{className:"py-2 px-4",children:"GPU VRAM"}),(0,i.jsx)("td",{className:"py-2 px-4",children:"Active layers, KV cache"}),(0,i.jsx)("td",{className:"py-2 pl-4",children:"~1 TB/s"})]}),(0,i.jsxs)("tr",{className:"border-b border-white/[0.05]",children:[(0,i.jsx)("td",{className:"py-2 pr-4 text-yellow-400",children:"Warm"}),(0,i.jsx)("td",{className:"py-2 px-4",children:"System RAM"}),(0,i.jsx)("td",{className:"py-2 px-4",children:"Offloaded layers (zStream)"}),(0,i.jsx)("td",{className:"py-2 pl-4",children:"~50 GB/s"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"py-2 pr-4 text-blue-400",children:"Cold"}),(0,i.jsx)("td",{className:"py-2 px-4",children:"Disk (.zse)"}),(0,i.jsx)("td",{className:"py-2 px-4",children:"Model weights"}),(0,i.jsx)("td",{className:"py-2 pl-4",children:"~3 GB/s (NVMe)"})]})]})]})}),(0,i.jsxs)(n.U,{type:"tip",children:["The ",(0,i.jsx)(l.Z,{children:".zse"})," format is designed for memory-mapped loading, which means the OS kernel efficiently pages weights from disk as needed."]})]}),(0,i.jsx)(r.KO,{prev:{title:"First Model",href:"/docs/first-model"},next:{title:"Model Formats",href:"/docs/model-formats"}})]}),(0,i.jsx)(r.o5,{items:c})]})}},4987:function(e,t,s){"use strict";s.d(t,{Rg:function(){return a},VS:function(){return c},Zb:function(){return d},gy:function(){return o}});var i=s(3827),r=s(5293),l=s(9259),n=s(2169);function a(e){let{steps:t}=e;return(0,i.jsx)("div",{className:"my-6 space-y-0",children:t.map((e,s)=>(0,i.jsxs)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*s},className:"relative pl-8 pb-8 last:pb-0",children:[s<t.length-1&&(0,i.jsx)("div",{className:"absolute left-[11px] top-6 bottom-0 w-px bg-white/10"}),(0,i.jsx)("div",{className:"absolute left-0 top-0 w-6 h-6 rounded-full bg-lime/20 border border-lime/40 flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-xs font-bold text-lime",children:s+1})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-base font-semibold text-white mb-1",children:e.title}),e.description&&(0,i.jsx)("p",{className:"text-sm text-white/50 mb-3",children:e.description}),e.code&&(0,i.jsx)("pre",{className:"bg-white/[0.03] border border-white/[0.06] rounded-lg p-3 overflow-x-auto my-2",children:(0,i.jsx)("code",{className:"text-sm text-lime/90 font-mono",children:e.code})}),e.content&&(0,i.jsx)("div",{className:"text-sm text-white/70",children:e.content})]})]},s))})}function c(e){let{features:t}=e;return(0,i.jsx)("ul",{className:"my-4 space-y-2",children:t.map((e,t)=>(0,i.jsxs)(r.E.li,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*t},className:"flex items-start gap-2",children:[(0,i.jsx)(l.Z,{className:"w-4 h-4 text-lime mt-0.5 flex-shrink-0"}),(0,i.jsx)("span",{className:"text-sm text-white/70",children:e})]},t))})}function d(e){let{title:t,description:s,icon:l,href:a,children:c}=e,d=a?"a":"div";return(0,i.jsx)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:a?{y:-2}:void 0,children:(0,i.jsxs)(d,{...a?{href:a,className:"block"}:{},className:(0,n.cn)("p-4 rounded-lg border border-white/[0.06] bg-white/[0.02]",a&&"hover:border-lime/30 hover:bg-white/[0.04] transition-all cursor-pointer"),children:[l&&(0,i.jsx)("div",{className:"w-8 h-8 rounded-lg bg-lime/10 flex items-center justify-center mb-3",children:(0,i.jsx)(l,{className:"w-4 h-4 text-lime"})}),(0,i.jsx)("h4",{className:"text-base font-semibold text-white mb-1",children:t}),s&&(0,i.jsx)("p",{className:"text-sm text-white/50",children:s}),c]})})}function o(e){let{children:t,columns:s=2}=e;return(0,i.jsx)("div",{className:(0,n.cn)("grid gap-4 my-6",2===s&&"md:grid-cols-2",3===s&&"md:grid-cols-3"),children:t})}}},function(e){e.O(0,[5293,2150,2716,2971,8069,1744],function(){return e(e.s=3726)}),_N_E=e.O()}]);